sigma=300
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
m9 <- lm(yobs ~ x)
summary(m9)
(cor(yobs, x))^2 # it's equal
data <- data.frame(cbind(yobs, x))
ybar0 <- mean(data[data$x==0,1])
ybar10 <- mean(data[data$x==10,1])
ybar20 <- mean(data[data$x==20,1])
ybar30 <- mean(data[data$x==30,1])
ybar40 <- mean(data[data$x==40,1])
ybar50 <- mean(data[data$x==50,1])
data$ybar <- c(rep(ybar0,10), rep(ybar10,10), rep(ybar20, 10), rep(ybar30, 10),
rep(ybar40, 10), rep(ybar50, 10))
(cor(data$yobs, data$ybar))^2
(cor(data$x, data$ybar))^2
cor(data$x, data$ybar)
x <- runif(n, 0,30)
x
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
plot(density(yobs))
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
plot(density(yobs))
plot(density(x))
plot(x, yobs)
b1 <- 5
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
b1 <- 1
s
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
b <- 0
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
plot(x, yobs)
sigma=1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
b <- 10
b1 <- 0
sigma=1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=0
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
x <- rnorm(100, 10, 0)
plot(density(x))
yobs <- b + b1*x + error
lwngth(x)
length(x)
length(error)
n=100
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
plot(density(yobs))
m9 <- lm(yobs ~ x)
summary(m9)
anova(m9)
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
b1 <- 0.1
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
b1 <- 1
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
x <- rnorm(100, 10, 10)
set.seed(0)
x <- rnorm(100, 10, 10)
yobs <- b + b1*x + error
plot(x, yobs)
b1 <- 0
yobs <- b + b1*x + error
plot(x, yobs)
b1 <- 0
yobs <- b + b1*x + error
plot(x, yobs)
b1
sigma=100
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
plot(x, yobs)
b1 <- -10
yobs <- b + b1*x + error
plot(x, yobs)
b1 <- 10
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
plot(x, yobs)
par(mfrow=c(1,1))
plot(x, yobs)
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
yobs
x
summary(error)
b1 <- 0
sigma=100
n=60
set.seed(0)
x <- c(rep(0,10), rep(10,10), rep(20, 10), rep(30, 10), rep(40, 10), rep(50, 10))
plot(density(x))
#True regression parameters
b <- 20
b1 <- 0
sigma=100
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
m9 <- lm(yobs ~ x)
summary(m9)
n=100
set.seed(0)
x <- rnorm(100, 10, 10)
plot(density(x))
#True regression parameters
b <- 10
b1 <- 0
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
#Getting the observed values of y
yobs <- b + b1*x + error
#checking it out
summary(yobs)
sigma=1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
summary(x)
b <- 1
yobs <- b + b1*x + error
summary(yobs)
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
b1*x
b
1+error
sigma=0.1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
yobs
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
set.seed(10)
x <- rnorm(100, 10, 10)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
b <- 10
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
x <- rnorm(100, 10, 0.1)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
x <- rnorm(100, 10, 0.0001)
x <- rnorm(100, 10, 0.1)
b1 <- 0.01
yobs <- b + b*x + error
summary(yobs)
summary(x)
summary(error)
yobs <- b + b*x + error
summary(yobs)
b
b*x
summary(b)
summary(x)
yobs <- b + b1*x + error
summary(yobs)
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
sigma=0.01
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
sigma=0.00001
set.seed(0)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
b1 <- 0.1
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
yobs <- b
m9 <- lm(yobs ~ x)
yobs <- rep(b,100)
m9 <- lm(yobs ~ x)
summary(m9)
x <- rep(10, 100)
m9 <- lm(yobs ~ x)
summary(m9)
yobs <- rep(b,100)+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
cor(x,yobs)
summary(yobs)
summary(x)
sigma=0.001
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- rep(b,100)+ b1*x + error
cor(x,yobs)
summary(yobs)
summary(x)
x <- rnorm(100, 10, 0.5)
yobs <- rep(b,100)+ b1*x + error
cor(yobs,x)
summary(yobs)
summary(x)
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
b1 <- 0.001
yobs <- rep(b,100)+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=0.1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- rep(b,100)+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
set.seed(10)
x <- rnorm(100, 10, 0.5)
plot(density(x))
#True regression parameters
b <- 10
b1 <- 0.01
sigma=0.001
set.seed(0)
error <- rnorm(n,0, sigma)
#Getting the observed values of y
yobs <- rep(b,100)+ b1*x + error
#checking it out
summary(yobs)
plot(density(yobs))
# Fitting a regression model to estimate regression coefficients and fitted values of y
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
yobs <- rep(b,100)+ b1*x
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
error <- 0
yobs <- rep(b,100)+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
yobs <- b+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
error
df <-  data.frame(a=c(1,2,4,2),b=c(2,6,2,1),c=c(2.6,8.2,7.5,3))
str(df)
head(df)
as.numeric(df[1,])
for { (i in 1:nrow(df))
kk[ncol(df)*(i-1)+i] <- as.numeric(df[i,])
}
kk <- rep(NA, nrow(df)*ncol(df))
kk
length(kk)
for { (i in 1:nrow(df))
kk[ncol(df)*(i-1)+i] <- as.numeric(df[i,])
}
for (i in 1:nrow(df)){
kk[ncol(df)*(i-1)+i] <- as.numeric(df[i,])
}
kk
nrow(df)
kk <- rep(NA, nrow(df)*ncol(df))
for (i in 1:nrow(df)){
kk[ncol(df)*(i-1)+i:i+2] <- as.numeric(df[i,])
}
kk
as.numeric(df[1,])
nrow(df)
kk <- rep(NA, nrow(df)*ncol(df))
for (i in 1:nrow(df)){
kk[(ncol(df)*(i-1)+i):(ncol(df)*(i-1)+2)] <- as.numeric(df[i,])
}
kk
kk <- rep(NA, nrow(df)*ncol(df))
for (i in 1:nrow(df)){
kk[(ncol(df)*(i-1))+i):(ncol(df)*(i-1))+2)] <- as.numeric(df[i,])
}
for (i in 1:nrow(df)){
kk[(ncol(df)*(i-1))+i:(ncol(df)*(i-1))+2] <- as.numeric(df[i,])
}
kk[(ncol(df)*(1-1))+1:(ncol(df)*(1-1))+2]
kk
kk <- seq(1:12)
kk
kk[(ncol(df)*(1-1))+1:(ncol(df)*(1-1))+2]
kk[(ncol(df)*(1-1))+1:(ncol(df)*(1-1))+1+2]
kk[((ncol(df)*(1-1)))+1:((ncol(df)*(1-1)))+1+2]
kk[((ncol(df)*(1-1))+1):((ncol(df)*(1-1))+1+2)]
kk <- rep(NA, nrow(df)*ncol(df))
for (i in 1:nrow(df)){
kk[((ncol(df)*(i-1))+i):((ncol(df)*(i-1))+i+2)] <- as.numeric(df[i,])
}
kk
as.numeric(df[1,])
nrow(df)
ncol(df)
length(kk)
kk <- rep(NA, nrow(df)*ncol(df))
length(kk)
kk <- seq(1:12)
length(kk)
kk[((ncol(df)*(1-1))+1):((ncol(df)*(1-1))+1+2)]
kk[((ncol(df)*(i-1))+i):((ncol(df)*(i-1))+i+2)]
kk[((ncol(df)*(1-1))+1):((ncol(df)*(1-1))+1+2)]
kk[((ncol(df)*(2-1))+2):((ncol(df)*(2-1))+2+2)]
ncol(df)
kk[((ncol(df)*(1-1))+1):((ncol(df)*(1-1))+1+2)]
kk[((ncol(df)*(2-1))+1):((ncol(df)*(2-1))+1+2)]
kk[((ncol(df)*(3-1))+1):((ncol(df)*(3-1))+1+2)]
kk[((ncol(df)*(4-1))+1):((ncol(df)*(4-1))+1+2)]
kk <- rep(NA, nrow(df)*ncol(df))
for (i in 1:nrow(df)){
kk[((ncol(df)*(i-1))+1):((ncol(df)*(i-1))+1+2)] <- as.numeric(df[i,])
}
kk
head(df)
setwd("C:/Users/tyatabe/OneDrive/Docs/PhD Epi/Spring 2016/EPI 226/HW/HW8")
ame <- read.dta("amenorrhea.dta")
library(foreign)
library(geepack)
library(lme4)
ame <- read.dta("amenorrhea.dta")
head(ame)
ame$time2 <- ame$time^2
ame$trt.time <- ame$trt*ame$time
ame$trt.time2 <- ame$trt*ame$time2
m6 <- glmer(y ~ time + time2 + trt.time + trt.time2 + (1 | id), data=ame,
family=binomial, nAGQ=50, na.action=na.omit)
summary(m6)
m6 <- glmer(y ~ time + time2 + trt.time + trt.time2 + (1 | id), data=ame,
family=binomial, nAGQ=1, na.action=na.omit)
summary(m6)
m6 <- glmer(y ~ time + time2 + trt.time + trt.time2 + (1 | id), data=ame,
family=binomial, nAGQ=100, na.action=na.omit)
summary(m6)
4*1.13319 - 16*0.04192
exp(3.86204)
4*(1.13319+0.56444)-16(0.04192+0.10955)
4*(1.13319+0.56444)-16*(0.04192+0.10955)
exp(4.367)
exp(4.367-3.86204)
var2cov(m6)
covm(m6)
vcov(m6)
kk <- (4^2*0.071935992) + (16^2*0.003003879) -(2*0.014207912)
kk
kk <- (4^2*0.036955678) + (16^2*0.0024611049) -(2*0.0090876716)
kk
sqrt(kk)
4.367-3.86204
pp <- 4.367-3.86204
pp-1.96*sqrt(kk)
lb <- pp-1.96*sqrt(kk)
exp(lb)
ub <- pp+1.96*sqrt(kk)
exp(ub)
kk <- (4^2)*0.036955678 + (16^2)*0.0024611049 -(2*0.0090876716)
kk
(4^2)*0.036955678
kk <- (4^2)*0.036955678 + (16^2)*0.0024611049 -(2*4*16*0.0090876716)
kk
lb <- pp-1.96*sqrt(kk)
ub <- pp+1.96*sqrt(kk)
exp(lb)
exp(ub)
lb
ub
m7 <- geeglm(y ~ time + time2 + trt.time + trt.time2, data=ame, id = id,
waves=time, family=binomial("logit"), corstr="unstructured",
std.err="san.se")
summary(m7)
summary(m3)
toe <- read.dta("toenail.dta")
m3 <- geeglm(y ~ month + I(trt*month), data=toe, id = id, waves=visit, family=binomial("logit"),
corstr="ar1", std.err="san.se")
summary(m3)
summary(m4)
summary(m7)
?geeglm
m7 <- geeglm(y ~ time + time2 + trt.time + trt.time2, data=ame, id = id,
waves=time, family=binomial("logit"), corstr="unstructured",
std.err="san.se", scale.fix=T, scale.value=1)
m7 <- geeglm(y ~ time + time2 + trt.time + trt.time2, data=ame, id = id,
waves=time, family=binomial("logit"), corstr="unstructured",
std.err="san.se", scale.fix=T)
summary(m7)
summary(ame)
m7 <- geeglm(y ~ time + time2 + trt.time + trt.time2, data=ame, id = id,
waves=time, family=binomial("logit"), corstr="unstructured",
std.err="san.se", scale.fix=T, scale.value=c(1,1,1,1))
m7 <- geeglm(y ~ time + time2 + trt.time + trt.time2, data=ame, id = id,
waves=time, family=binomial("logit"), corstr="unstructured",
std.err="san.se", scale.fix=T, scale.value=c(1,1,1,1,1))
m7 <- geeglm(y ~ time + time2 + trt.time + trt.time2, data=ame, id = id,
waves=time, family=binomial("logit"), corstr="unstructured",
std.err="san.se", scale.fix=T)
summary(m7)
exp(0.343)
exp(0.259)
exp(0.425)
exp(0.499)
4*0.3379 - 16*0.0690
exp(0.248)
vcov(m7)
vcov(m7, type="pearson")
?vcov
vcov(m7)
variance(m7)
?geeglm
m7$geese$vbeta
summary(m7)
m7$geese$vbeta
kk <- 4^2*0.01203+16^2*0.000807-2*4*16*0.002960
kk
lb <- 0.248-1.96*sqrt(kk)
exp(lb)
ub <- 0.248+1.96*sqrt(kk)
ub
lb
exp(ub)
