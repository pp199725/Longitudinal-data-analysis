n=50
set.seed(0)
error <- rnorm(n,0, sigma)
plot(density(x))
yobs <- b + b1*x + error
n=50
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
n=60
set.seed(0)
error <- rnorm(n,0, sigma)
plot(density(x))
yobs <- b + b1*x + error
summary(yobs)
plot(density(yobs))
m9 <- lm(yobs ~ x)
summary(m9)
(cor(yobs, x))^2
data <- data.frame(cbind(yobs, x))
head(data)
tail(data)
mean(yobs[$x==0$,1])
mean(yobs[$x==0,1])
mean(data[data$x==0,1])
mean(data[data$x==10,1])
ybar0 <- mean(data[data$x==0,1])
ybar10 <- mean(data[data$x==10,1])
ybar20 <- mean(data[data$x==20,1])
ybar30 <- mean(data[data$x==30,1])
ybar40 <- mean(data[data$x==40,1])
ybar50 <- mean(data[data$x==50,1])
rep(ybar0,10)
data$ybar <- c(rep(ybar0,10), rep(ybar10,10), rep(ybar20, 10), rep(ybar30, 10),
rep(ybar40, 10), rep(ybar50, 10))
tail(data)
head(data)
(cor(data$yobs, data$ybar))^2
summary(m9)
m9$fitted.values[10]
m9$fitted.values[1:10]
mean(m9$fitted.values[1:10])
sigma=200
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=300
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
m9 <- lm(yobs ~ x)
summary(m9)
(cor(yobs, x))^2 # it's equal
data <- data.frame(cbind(yobs, x))
ybar0 <- mean(data[data$x==0,1])
ybar10 <- mean(data[data$x==10,1])
ybar20 <- mean(data[data$x==20,1])
ybar30 <- mean(data[data$x==30,1])
ybar40 <- mean(data[data$x==40,1])
ybar50 <- mean(data[data$x==50,1])
data$ybar <- c(rep(ybar0,10), rep(ybar10,10), rep(ybar20, 10), rep(ybar30, 10),
rep(ybar40, 10), rep(ybar50, 10))
(cor(data$yobs, data$ybar))^2
(cor(data$x, data$ybar))^2
cor(data$x, data$ybar)
x <- runif(n, 0,30)
x
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
plot(density(yobs))
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
plot(density(yobs))
plot(density(x))
plot(x, yobs)
b1 <- 5
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
b1 <- 1
s
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
b <- 0
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
plot(x, yobs)
sigma=1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
b <- 10
b1 <- 0
sigma=1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=0
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
x <- rnorm(100, 10, 0)
plot(density(x))
yobs <- b + b1*x + error
lwngth(x)
length(x)
length(error)
n=100
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
plot(density(yobs))
m9 <- lm(yobs ~ x)
summary(m9)
anova(m9)
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
b1 <- 0.1
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
b1 <- 1
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
x <- rnorm(100, 10, 10)
set.seed(0)
x <- rnorm(100, 10, 10)
yobs <- b + b1*x + error
plot(x, yobs)
b1 <- 0
yobs <- b + b1*x + error
plot(x, yobs)
b1 <- 0
yobs <- b + b1*x + error
plot(x, yobs)
b1
sigma=100
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
plot(x, yobs)
b1 <- -10
yobs <- b + b1*x + error
plot(x, yobs)
b1 <- 10
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
plot(x, yobs)
par(mfrow=c(1,1))
plot(x, yobs)
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
yobs
x
summary(error)
b1 <- 0
sigma=100
n=60
set.seed(0)
x <- c(rep(0,10), rep(10,10), rep(20, 10), rep(30, 10), rep(40, 10), rep(50, 10))
plot(density(x))
#True regression parameters
b <- 20
b1 <- 0
sigma=100
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
m9 <- lm(yobs ~ x)
summary(m9)
n=100
set.seed(0)
x <- rnorm(100, 10, 10)
plot(density(x))
#True regression parameters
b <- 10
b1 <- 0
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
#Getting the observed values of y
yobs <- b + b1*x + error
#checking it out
summary(yobs)
sigma=1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
summary(x)
b <- 1
yobs <- b + b1*x + error
summary(yobs)
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
b1*x
b
1+error
sigma=0.1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
yobs
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
set.seed(10)
x <- rnorm(100, 10, 10)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
b <- 10
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
x <- rnorm(100, 10, 0.1)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
x <- rnorm(100, 10, 0.0001)
x <- rnorm(100, 10, 0.1)
b1 <- 0.01
yobs <- b + b*x + error
summary(yobs)
summary(x)
summary(error)
yobs <- b + b*x + error
summary(yobs)
b
b*x
summary(b)
summary(x)
yobs <- b + b1*x + error
summary(yobs)
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
sigma=0.01
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
sigma=0.00001
set.seed(0)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
b1 <- 0.1
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
yobs <- b
m9 <- lm(yobs ~ x)
yobs <- rep(b,100)
m9 <- lm(yobs ~ x)
summary(m9)
x <- rep(10, 100)
m9 <- lm(yobs ~ x)
summary(m9)
yobs <- rep(b,100)+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
cor(x,yobs)
summary(yobs)
summary(x)
sigma=0.001
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- rep(b,100)+ b1*x + error
cor(x,yobs)
summary(yobs)
summary(x)
x <- rnorm(100, 10, 0.5)
yobs <- rep(b,100)+ b1*x + error
cor(yobs,x)
summary(yobs)
summary(x)
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
b1 <- 0.001
yobs <- rep(b,100)+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=0.1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- rep(b,100)+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
set.seed(10)
x <- rnorm(100, 10, 0.5)
plot(density(x))
#True regression parameters
b <- 10
b1 <- 0.01
sigma=0.001
set.seed(0)
error <- rnorm(n,0, sigma)
#Getting the observed values of y
yobs <- rep(b,100)+ b1*x + error
#checking it out
summary(yobs)
plot(density(yobs))
# Fitting a regression model to estimate regression coefficients and fitted values of y
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
yobs <- rep(b,100)+ b1*x
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
error <- 0
yobs <- rep(b,100)+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
yobs <- b+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
error
setwd("C:/Users/tyatabe/OneDrive/Docs/PhD Epi/Spring 2016/EPI 226/HW/HW4")
setwd("C:/Users/tyatabe/OneDrive/Docs/PhD Epi/Spring 2016/EPI 226/HW/HW5")
ex <- read.table("exercise-data.txt")
str(ex)
colnames(ex) <- c("ID", "group" "d0", "d2", "d4", "d6", "d8", "d10", "d12")
colnames(ex) <- c("ID", "group", "d0", "d2", "d4", "d6", "d8", "d10", "d12")
head(ex)
str(ex)
summary(ex)
exe <- ex[,1:3&5:7&9]
head(exe)
exe <- ex[,c(1:3, 5:7, 9)]
head(exe)
str(exe)
summary(exe)
d <- reshape(exe, varying=c("d0", "d4", "d6", "d8", "d12"), direction="long", v.names="strength",
idvar="ID")
head(d)
tail(d)
d <- d[order(d$ID),]
row.names(d) <- NULL
d[1:20,]
summary(d)
install.packages("foreign")
library(foreign)
ex <- read.table("exercise.dta")
head(ex)
tail(ex)
summary(ex)
ex <- read.dta("exercise.dta")
head(ex)
d <- reshape(ex, varying=c("y0", "y2", "y4", "y6", "y8", "y10", "y12"), direction="long", v.names="strength",
idvar="id", timevar="time", time=0:6)
head(d)
d <- d[order(d$ID),]
d <- d[order(d$id),]
head(d)
row.names(d) <- NULL
d[1:20,]
str(d)
d <- subset(d, time!=1 & time!=5)
str(exe)
summary(exe)
str(d)
summary(d)
d[1:20,]
d$day <- time*2
class(d$time)
d$day <- d$time*2
d$day.f <- factor(d$day, c(0,4,6,8,12))
d$group.f <- factor(d$group, c(1,2))
head(d)
summary(d)
d$newtime <- d$time
d$newtime[d$time==0] <- 1
d$newtime[d$time==2] <- 2
d$newtime[d$time==3] <- 3
d$newtime[d$time==4] <- 4
d$newtime[d$time==6] <- 5
summary(d)
m1 <- gls(strength~group.f*day.f, data=d, na.action=na.omit,
corr=corSymm(, form= ~ newtime | id),weights = varIdent(form = ~ 1 | newtime))
library(nlme)
m1 <- gls(strength~group.f*day.f, data=d, na.action=na.omit,
corr=corSymm(, form= ~ newtime | id),weights = varIdent(form = ~ 1 | newtime))
summary(m1)
getVarCov(m1)
?getVarCov
cov2cor(getVarCov(m1))
m2 <- gls(strength~group.f*day.f, data=d, na.action=na.omit,
corr=corAR1(, form= ~ newtime | id), method="REML")
summary(m2)
cov2cor(getVarCov(m2))
summary(d)
m3 <- gls(strength ~ group.f*day.f, data=d, na.action=na.omit,
corr=corExp(, form= ~ day | id), method="REML")
summary(m3)
cov2cor(getVarCov(m3))
dev1 <- -2*logLik(m1)
dev2 <- -2*logLik(m2)
dev3 <- -2*logLik(m3)
dev1
aic(m1)
anova(m1, m2, m3)
AIC(m1)
dev1
aic1 <- AIC(m1)
aic2 <- AIC(m2)
aic3 <- AIC(m2)
aic1
aic2
aic3 <- AIC(m3)
aic3
dev1
dev2
dev3
10+5+(5*(5-1)/2)
dev1 <- -2*logLik(m1)
dev2 <- -2*logLik(m2)
dev3 <- -2*logLik(m3)
#AIC's...these are different than the ones computed by SAS...I think SAS is wrong
aic1 <- AIC(m1)
aic2 <- AIC(m2)
aic3 <- AIC(m3)
dev <- c(dev1, dev2, dev3)
aic <- c(aic1, aic2, aic3)
aic
model <- c("UN", "AR1", "Exp")
table34 <- data.frame(model, dev, aic)
table34
summary(m2)
anova(m2)
getVarCov(m2)
cov2cor(getVarCov(m2))
getVarCov(m3)
summary(m3)
cov2cor(getVarCov(m3))
?getAnywhere
getAnywhere("Phi1")
getAnywhere("Phi")
getAnywhere("rho")
getAnywhere("Rho")
m3$modelStruct$corStruct
m2$modelStruct$corStruct
x<-m3$model$Struct$corStruct
x
x <- m3$modelStruct$corStruct
coef(x,unconstrained=FALSE)
m2$modelStruct$corStruct
