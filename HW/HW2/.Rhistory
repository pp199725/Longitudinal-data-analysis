plot(density(yobs))
m9 <- lm(yobs ~ x)
summary(m9)
set.seed(0)
x <- runif(n, 1, 30)
plot(density(x))
yobs <- b + b1*x + error
summary(yobs)
plot(density(yobs))
m9 <- lm(yobs ~ x)
summary(m9)
anova(m9)
cor(m9$fits, yobs)
str(m9$fits)
str(m9)
cor(m9$fitted.values, yobs)
summary(m9)
cor(m9$fitted.values, x)
cor(yobs, x)
(cor(yobs, x))^2
cor(rep(mean(yobs), 100), x)
par(mfrow=c(1,2))
par(mfrow=c(2,2))
windows()
plot(m9)
sigma=100
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
plot(density(yobs))
plot(density(x))
plot(density(yobs))
m9 <- lm(yobs ~ x)
summary(m9)
anova(m9)
(cor(yobs, x))^2
x <- c(rep(0,10), rep(10,10), rep(20, 10), rep(30, 10), rep(40, 10), rep(50, 10))
x
n=50
set.seed(0)
error <- rnorm(n,0, sigma)
plot(density(x))
yobs <- b + b1*x + error
n=50
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
n=60
set.seed(0)
error <- rnorm(n,0, sigma)
plot(density(x))
yobs <- b + b1*x + error
summary(yobs)
plot(density(yobs))
m9 <- lm(yobs ~ x)
summary(m9)
(cor(yobs, x))^2
data <- data.frame(cbind(yobs, x))
head(data)
tail(data)
mean(yobs[$x==0$,1])
mean(yobs[$x==0,1])
mean(data[data$x==0,1])
mean(data[data$x==10,1])
ybar0 <- mean(data[data$x==0,1])
ybar10 <- mean(data[data$x==10,1])
ybar20 <- mean(data[data$x==20,1])
ybar30 <- mean(data[data$x==30,1])
ybar40 <- mean(data[data$x==40,1])
ybar50 <- mean(data[data$x==50,1])
rep(ybar0,10)
data$ybar <- c(rep(ybar0,10), rep(ybar10,10), rep(ybar20, 10), rep(ybar30, 10),
rep(ybar40, 10), rep(ybar50, 10))
tail(data)
head(data)
(cor(data$yobs, data$ybar))^2
summary(m9)
m9$fitted.values[10]
m9$fitted.values[1:10]
mean(m9$fitted.values[1:10])
sigma=200
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=300
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
m9 <- lm(yobs ~ x)
summary(m9)
(cor(yobs, x))^2 # it's equal
data <- data.frame(cbind(yobs, x))
ybar0 <- mean(data[data$x==0,1])
ybar10 <- mean(data[data$x==10,1])
ybar20 <- mean(data[data$x==20,1])
ybar30 <- mean(data[data$x==30,1])
ybar40 <- mean(data[data$x==40,1])
ybar50 <- mean(data[data$x==50,1])
data$ybar <- c(rep(ybar0,10), rep(ybar10,10), rep(ybar20, 10), rep(ybar30, 10),
rep(ybar40, 10), rep(ybar50, 10))
(cor(data$yobs, data$ybar))^2
(cor(data$x, data$ybar))^2
cor(data$x, data$ybar)
x <- runif(n, 0,30)
x
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
plot(density(yobs))
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
plot(density(yobs))
plot(density(x))
plot(x, yobs)
b1 <- 5
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
b1 <- 1
s
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
b <- 0
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
plot(x, yobs)
sigma=1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
b <- 10
b1 <- 0
sigma=1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=0
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
x <- rnorm(100, 10, 0)
plot(density(x))
yobs <- b + b1*x + error
lwngth(x)
length(x)
length(error)
n=100
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
plot(density(yobs))
m9 <- lm(yobs ~ x)
summary(m9)
anova(m9)
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
b1 <- 0.1
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
b1 <- 1
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
x <- rnorm(100, 10, 10)
set.seed(0)
x <- rnorm(100, 10, 10)
yobs <- b + b1*x + error
plot(x, yobs)
b1 <- 0
yobs <- b + b1*x + error
plot(x, yobs)
b1 <- 0
yobs <- b + b1*x + error
plot(x, yobs)
b1
sigma=100
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
plot(x, yobs)
b1 <- -10
yobs <- b + b1*x + error
plot(x, yobs)
b1 <- 10
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
plot(x, yobs)
par(mfrow=c(1,1))
plot(x, yobs)
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
yobs
x
summary(error)
b1 <- 0
sigma=100
n=60
set.seed(0)
x <- c(rep(0,10), rep(10,10), rep(20, 10), rep(30, 10), rep(40, 10), rep(50, 10))
plot(density(x))
#True regression parameters
b <- 20
b1 <- 0
sigma=100
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
m9 <- lm(yobs ~ x)
summary(m9)
n=100
set.seed(0)
x <- rnorm(100, 10, 10)
plot(density(x))
#True regression parameters
b <- 10
b1 <- 0
sigma=10
set.seed(0)
error <- rnorm(n,0, sigma)
#Getting the observed values of y
yobs <- b + b1*x + error
#checking it out
summary(yobs)
sigma=1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
summary(yobs)
summary(x)
b <- 1
yobs <- b + b1*x + error
summary(yobs)
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
b1*x
b
1+error
sigma=0.1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
yobs
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
set.seed(10)
x <- rnorm(100, 10, 10)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
b <- 10
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
x <- rnorm(100, 10, 0.1)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
x <- rnorm(100, 10, 0.0001)
x <- rnorm(100, 10, 0.1)
b1 <- 0.01
yobs <- b + b*x + error
summary(yobs)
summary(x)
summary(error)
yobs <- b + b*x + error
summary(yobs)
b
b*x
summary(b)
summary(x)
yobs <- b + b1*x + error
summary(yobs)
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
sigma=0.01
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
sigma=0.00001
set.seed(0)
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
b1 <- 0.1
yobs <- b + b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
yobs <- b
m9 <- lm(yobs ~ x)
yobs <- rep(b,100)
m9 <- lm(yobs ~ x)
summary(m9)
x <- rep(10, 100)
m9 <- lm(yobs ~ x)
summary(m9)
yobs <- rep(b,100)+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
cor(x,yobs)
summary(yobs)
summary(x)
sigma=0.001
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- rep(b,100)+ b1*x + error
cor(x,yobs)
summary(yobs)
summary(x)
x <- rnorm(100, 10, 0.5)
yobs <- rep(b,100)+ b1*x + error
cor(yobs,x)
summary(yobs)
summary(x)
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
b1 <- 0.001
yobs <- rep(b,100)+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
sigma=0.1
set.seed(0)
error <- rnorm(n,0, sigma)
yobs <- rep(b,100)+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
set.seed(10)
x <- rnorm(100, 10, 0.5)
plot(density(x))
#True regression parameters
b <- 10
b1 <- 0.01
sigma=0.001
set.seed(0)
error <- rnorm(n,0, sigma)
#Getting the observed values of y
yobs <- rep(b,100)+ b1*x + error
#checking it out
summary(yobs)
plot(density(yobs))
# Fitting a regression model to estimate regression coefficients and fitted values of y
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
yobs <- rep(b,100)+ b1*x
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
error <- 0
yobs <- rep(b,100)+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
yobs <- b+ b1*x + error
m9 <- lm(yobs ~ x)
summary(m9)
plot(x, yobs)
abline(m9)
error
setwd("C:/Users/tyatabe/OneDrive/Docs/PhD Epi/Spring 2016/EPI 226/HW/HW2")
ead <- read.table("lead-data.txt")
#Tidying it up
colnames(lead) <- c("ID", "Base", "wk1", "wk4", "wk6")
# Checking it out
head(lead)
summary(lead)
# Transforming from wide to long
d <- reshape(lead, varying=c("Base", "wk1", "wk4", "wk6"), direction="long", v.names="lead",
idvar="ID")
d <- d[order(d$ID),]
#Checking it out
d[1:20,]
str(d)
# Creating a factor for weeks
d$week <- d$time
d$week[d$time==1] <- 0
d$week[d$time==2] <- 1
d$week[d$time==3] <- 4
d$week[d$time==4] <- 6
d$week <- factor(d$week, c(0,1,4,6))
lead <- read.table("lead-data.txt")
#Tidying it up
colnames(lead) <- c("ID", "Base", "wk1", "wk4", "wk6")
# Checking it out
head(lead)
summary(lead)
# Transforming from wide to long
d <- reshape(lead, varying=c("Base", "wk1", "wk4", "wk6"), direction="long", v.names="lead",
idvar="ID")
d <- d[order(d$ID),]
#Checking it out
d[1:20,]
str(d)
# Creating a factor for weeks
d$week <- d$time
d$week[d$time==1] <- 0
d$week[d$time==2] <- 1
d$week[d$time==3] <- 4
d$week[d$time==4] <- 6
d$week <- factor(d$week, c(0,1,4,6))
summary(d)
#Reading in the data
tlc <- read.table("tlc-data.txt")
#Tidying it up
colnames(tlc) <- c("ID", "group","Base", "wk1", "wk4", "wk6")
# Checking it out
head(tlc)
str(tlc)
summary(tlc)
# Transforming from wide to long
d <- reshape(tlc, varying=c("Base", "wk1", "wk4", "wk6"), direction="long", v.names="lead",
idvar="ID")
d <- d[order(d$ID),]
#Checking it out
row.names(d) <- NULL
d[1:20,]
str(d)
d$week <- d$time
d$week[d$time==1] <- 0
d$week[d$time==2] <- 1
d$week[d$time==3] <- 4
d$week[d$time==4] <- 6
d$week <- factor(d$week, c(0,1,4,6))
summary(d)
# Changing the reference level of group variable to P
d<- within(d, group <- relevel(group, ref = 2))
library(nlme)
m1 <- gls(lead~ group*week, data=d, correlation= corSymm(form = ~ time | ID),
weights = varIdent(form = ~ 1 | time), method="REML")
anova(m1)
anova(m1, test="Chisq")
anova(m1, test="LRT")
anova.glm(m1, test="Chisq")
anova(m1, test.statistics="Chisq")
class(m1)
anova(m1, test.statistic="Wald")
Anova(m1, test.statistic="Wald")
library(lmer)
install.packages("lmer")
library(lmer)
?nova
?anova
??anova
print(m1)
str(m1)
Anova(m1, test.statistic="Wald")
anova(m1)
summary(m1)
summary(m1)
